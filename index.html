<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dota 2 Spy Tool</title>
    <style>
        :root {
            --bg-color: #1b1b1b;
            --card-bg: #252525;
            --text-color: #e0e0e0;
            --str-color: #ec3d06;
            --agi-color: #26e030;
            --int-color: #00d9ec;
            --uni-color: #d89e0e;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
        }

        /* --- Controls Section --- */
        .controls {
            position: sticky;
            top: 0;
            background: #2b2b2b;
            padding: 15px;
            border-bottom: 2px solid #444;
            z-index: 100;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            border-radius: 0 0 10px 10px;
            margin-bottom: 20px;
        }

        .search-box input {
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px solid #555;
            background: #111;
            color: white;
            width: 200px;
        }

        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .filter-label { font-weight: bold; color: #888; font-size: 0.9em; text-transform: uppercase;}

        .checkbox-btn {
            cursor: pointer;
            user-select: none;
            padding: 5px 10px;
            background: #333;
            border-radius: 4px;
            font-size: 0.9em;
            transition: 0.2s;
            border: 1px solid #444;
        }
        .checkbox-btn:hover { background: #444; }
        .checkbox-btn input { display: none; }
        .checkbox-btn input:checked + span { color: #fff; font-weight: bold; }
        .checkbox-btn:has(input:checked) { background: #555; border-color: #888; }

        /* Checkbox wrapper style */
        .checkbox-wrapper-23 {
            --size: 24px;
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
        }

        .checkbox-wrapper-23 *,
        .checkbox-wrapper-23 *:after,
        .checkbox-wrapper-23 *:before {
            box-sizing: border-box;
        }

        .checkbox-wrapper-23 input {
            position: absolute;
            opacity: 0;
            width: var(--size);
            height: var(--size);
            cursor: pointer;
            z-index: 1;
        }

        .checkbox-wrapper-23 input:checked + label svg path {
            stroke-dashoffset: 0;
        }

        .checkbox-wrapper-23 input:focus + label {
            transform: scale(1.03);
        }

        .checkbox-wrapper-23 input + label {
            display: block;
            border: 2px solid #666;
            width: var(--size);
            height: var(--size);
            border-radius: 6px;
            cursor: pointer;
            transition: all .2s ease;
            background: #1a1a1a;
        }

        .checkbox-wrapper-23 input:checked + label {
            border-color: #ec3d06;
            background: rgba(236, 61, 6, 0.1);
            box-shadow: 0 0 12px rgba(236, 61, 6, 0.4);
        }

        .checkbox-wrapper-23 input + label:active {
            transform: scale(1.05);
            border-radius: 12px;
        }

        .checkbox-wrapper-23 input + label svg {
            pointer-events: none;
            padding: 5%;
        }

        .checkbox-wrapper-23 input + label svg path {
            fill: none;
            stroke: #ec3d06;
            stroke-width: 4px;
            stroke-linecap: round;
            stroke-linejoin: round;
            stroke-dasharray: 100;
            stroke-dashoffset: 101;
            transition: all 250ms cubic-bezier(1,0,.37,.91);
        }

        .checkbox-wrapper-23 .checkbox-text {
            color: #888;
            font-size: 0.9em;
            text-transform: uppercase;
            font-weight: bold;
            letter-spacing: 0.5px;
            user-select: none;
            transition: color 0.3s ease;
            cursor: pointer;
        }

        .checkbox-wrapper-23 .checkbox-text:active {
            transform: scale(0.98);
        }

        .checkbox-wrapper-23:hover .checkbox-text {
            color: #aaa;
        }

        .checkbox-wrapper-23 input:checked ~ .checkbox-text {
            color: #ec3d06;
        }

        /* --- Main Layout --- */
        .main-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 4 Columns for attributes */
            gap: 20px;
        }

        @media (max-width: 1200px) { .main-container { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 768px) { .main-container { grid-template-columns: 1fr; } }

        .attr-column {
            background: rgba(255,255,255,0.02);
            padding: 10px;
            border-radius: 8px;
        }

        .attr-header {
            text-align: center;
            font-size: 1.5em;
            margin-bottom: 15px;
            text-transform: uppercase;
            border-bottom: 2px solid;
            padding-bottom: 5px;
        }

        .attr-str { border-color: var(--str-color); color: var(--str-color); }
        .attr-agi { border-color: var(--agi-color); color: var(--agi-color); }
        .attr-int { border-color: var(--int-color); color: var(--int-color); }
        .attr-uni { border-color: var(--uni-color); color: var(--uni-color); }

        /* --- Hero Card --- */
        .heroes-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .hero-card {
            background: var(--card-bg);
            border: 1px solid #333;
            border-radius: 6px;
            width: 140px;
            height: 180px;
            overflow: hidden;
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
        }

        .hero-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.7);
            border-color: #666;
        }
        
        .hero-card.eliminated {
            opacity: 0.2;
            filter: grayscale(100%);
            transform: scale(0.95);
            box-shadow: none;
        }

        .hero-card.eliminated.hide-eliminated {
            display: none;
        }
        
        .hero-card.hidden {
            display: none;
        }

        .hero-img {
            width: 100%;
            height: 80px;
            object-fit: cover;
            border-bottom: 1px solid #333;
        }

        .hero-info {
            padding: 8px;
            font-size: 0.85em;
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .hero-name {
            margin: 0 0 5px 0;
            font-size: 1.1em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .hero-name a {
            color: #fff;
            text-decoration: none;
            border-bottom: 1px dotted #777;
        }
        .hero-name a:hover { color: #ffcc00; border-bottom: 1px solid #ffcc00; }

        .hero-stats {
            color: #aaa;
            line-height: 1.4;
            flex: 1;
            overflow: hidden;
        }
        .roles-tags {
            font-size: 0.75em;
            color: #777;
            margin-top: 4px;
            font-style: italic;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
        }

    </style>
</head>
<body>

<div class="controls">
    <div class="search-box">
        <input type="text" id="searchInput" placeholder="Search...">
    </div>

    <div class="filter-group">
        <span class="filter-label">Atack:</span>
        <label class="checkbox-btn">
            <input type="checkbox" name="attack_type" value="Melee" checked>
            <span>Melee</span>
        </label>
        <label class="checkbox-btn">
            <input type="checkbox" name="attack_type" value="Ranged" checked>
            <span>Ranged</span>
        </label>
    </div>

    <div class="filter-group">
        <span class="filter-label">Roles:</span>
        <label class="checkbox-btn"><input type="checkbox" class="role-filter" value="Carry" checked><span>Carry</span></label>
        <label class="checkbox-btn"><input type="checkbox" class="role-filter" value="Support" checked><span>Support</span></label>
        <label class="checkbox-btn"><input type="checkbox" class="role-filter" value="Nuker" checked><span>Nuker</span></label>
        <label class="checkbox-btn"><input type="checkbox" class="role-filter" value="Disabler" checked><span>Disabler</span></label>
        <label class="checkbox-btn"><input type="checkbox" class="role-filter" value="Escape" checked><span>Escape</span></label>
        <label class="checkbox-btn"><input type="checkbox" class="role-filter" value="Durable" checked><span>Durable</span></label>
    </div>

    <div class="checkbox-wrapper-23">
        <input type="checkbox" id="showEliminatedCheckbox" checked>
        <label for="showEliminatedCheckbox">
            <svg viewBox="0,0,50,50">
                <path d="M5 30 L 20 45 L 45 5"></path>
            </svg>
        </label>
        <label for="showEliminatedCheckbox" class="checkbox-text">Show Hidden</label>
    </div>

    <div style="margin-left: auto;">
        <button onclick="resetAll()" style="background:#442222; color:white; border:none; padding:8px; cursor:pointer;">Reset</button>
    </div>
</div>

<div class="main-container">
    <div class="attr-column">
        <div class="attr-header attr-str">Strength</div>
        <div id="container-Strength" class="heroes-list"></div>
    </div>
    <div class="attr-column">
        <div class="attr-header attr-agi">Agility</div>
        <div id="container-Agility" class="heroes-list"></div>
    </div>
    <div class="attr-column">
        <div class="attr-header attr-int">Intelligence</div>
        <div id="container-Intelligence" class="heroes-list"></div>
    </div>
    <div class="attr-column">
        <div class="attr-header attr-uni">Universal</div>
        <div id="container-Universal" class="heroes-list"></div>
    </div>
</div>

<script>
    let heroesData = [];

    async function fetchHeroes() {
        try {
            const response = await fetch('https://api.opendota.com/api/heroes');
            const data = await response.json();
            
            heroesData = data.map(hero => {

                const attrMap = {
                    'str': 'Strength',
                    'agi': 'Agility',
                    'int': 'Intelligence',
                    'all': 'Universal'
                };
                
                const heroSlug = hero.name.replace('npc_dota_hero_', '');
                
                return {
                    id: hero.id,
                    name: hero.name,
                    localized_name: hero.localized_name,
                    primary_attr: attrMap[hero.primary_attr] || 'Universal',
                    attack_type: hero.attack_type,
                    roles: hero.roles || [],
                    legs: hero.legs || 2,
                    url: `https://www.dota2.com/hero/${heroSlug.replace(/_/g, '')}`,
                    imageUrl: `https://cdn.steamstatic.com/apps/dota2/images/dota_react/heroes/${heroSlug}.png`
                };
            });
            
            return heroesData;
        } catch (error) {
            console.error('Error fetching heroes:', error);
            return [];
        }
    }

   //const heroesData = __HEROES_JSON__;
   
    // --- ЛОГИКА ---

    async function init() {
        // Show loading state
        ['Strength', 'Agility', 'Intelligence', 'Universal'].forEach(attr => {
            const container = document.getElementById(`container-${attr}`);
            container.innerHTML = '<div style="text-align:center; padding:20px; color:#888;">Loading...</div>';
        });
        
        // Fetch heroes from API
        await fetchHeroes();
        
        // Render heroes
        renderHeroes(heroesData);
        setupEventListeners();
    }

    function renderHeroes(heroes) {
        ['Strength', 'Agility', 'Intelligence', 'Universal'].forEach(attr => {
            document.getElementById(`container-${attr}`).innerHTML = '';
        });

        heroes.forEach(hero => {
            const containerId = `container-${hero.primary_attr}`;
            const container = document.getElementById(containerId);
            
            if (!container) return;

            const card = document.createElement('div');
            card.className = 'hero-card';
            card.dataset.name = hero.localized_name.toLowerCase();
            card.dataset.attack = hero.attack_type;
            card.dataset.roles = JSON.stringify(hero.roles);
            
            card.onclick = (e) => {
                card.classList.toggle('eliminated');
                
                // Apply hide-eliminated class immediately if checkbox is unchecked
                const showEliminated = document.getElementById('showEliminatedCheckbox').checked;
                if (!showEliminated && card.classList.contains('eliminated')) {
                    card.classList.add('hide-eliminated');
                }
            };
            
            card.innerHTML = `
                <img src="${hero.imageUrl}" class="hero-img" alt="${hero.localized_name}">
                <div class="hero-info">
                    <h3 class="hero-name">
                        <a href="${hero.url}" target="_blank" onclick="event.stopPropagation()">${hero.localized_name}</a>
                    </h3>
                    <div class="hero-stats">
                        ${hero.attack_type}
                        <div class="roles-tags">${hero.roles.join(', ')}</div>
                    </div>
                </div>
            `;

            container.appendChild(card);
        });
    }

    function filterHeroes() {
        const searchText = document.getElementById('searchInput').value.toLowerCase();
        
        const attackCheckboxes = document.querySelectorAll('input[name="attack_type"]:checked');
        const allowedAttacks = Array.from(attackCheckboxes).map(cb => cb.value);

        const roleCheckboxes = document.querySelectorAll('.role-filter:checked');
        const selectedRoles = Array.from(roleCheckboxes).map(cb => cb.value);

        const allCards = document.querySelectorAll('.hero-card');

        allCards.forEach(card => {
            const name = card.dataset.name;
            const attack = card.dataset.attack;
            const roles = JSON.parse(card.dataset.roles);
            
            const matchesSearch = name.includes(searchText);
            const matchesAttack = allowedAttacks.includes(attack);
            
            // If any role filters are active, hero must match at least one selected role
            // If no role filters are active, hide all heroes
            const matchesRoles = selectedRoles.length > 0 && selectedRoles.some(r => roles.includes(r));

            if (matchesSearch && matchesAttack && matchesRoles) {
                card.classList.remove('hidden');
            } else {
                card.classList.add('hidden');
            }
        });
    }

    function toggleEliminatedVisibility() {
        const showEliminated = document.getElementById('showEliminatedCheckbox').checked;
        const eliminatedCards = document.querySelectorAll('.hero-card.eliminated');
        
        eliminatedCards.forEach(card => {
            if (showEliminated) {
                card.classList.remove('hide-eliminated');
            } else {
                card.classList.add('hide-eliminated');
            }
        });
    }

    function setupEventListeners() {
        document.getElementById('searchInput').addEventListener('input', filterHeroes);
        
        document.querySelectorAll('input[name="attack_type"]').forEach(cb => {
            cb.addEventListener('change', filterHeroes);
        });
        
        document.querySelectorAll('.role-filter').forEach(cb => {
            cb.addEventListener('change', filterHeroes);
        });

        const checkbox = document.getElementById('showEliminatedCheckbox');
        checkbox.addEventListener('change', toggleEliminatedVisibility);
        
        // Also add click handler to ensure it works
        checkbox.addEventListener('click', function(e) {
            // Let the default behavior happen, then trigger visibility update
            setTimeout(toggleEliminatedVisibility, 0);
        });
    }

    function resetAll() {
        document.querySelectorAll('.hero-card').forEach(card => {
            card.classList.remove('eliminated');
        });
    }
    
    init();

</script>
</body>
</html>